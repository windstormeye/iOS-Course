# Swift

è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½•æˆ‘åœ¨å­¦ä¹ Swiftçš„ä¸€äº›è®°å½•ã€Swiftæ˜¯14å¹´çš„WWDCä¸Šè‹¹æœæ¨å‡ºçš„ä¸€é—¨æ–°è¯­è¨€ï¼Œè¿™æ˜¯ä¸€é—¨éå¸¸æ–°çš„è¯­è¨€ï¼Œè€Œä¸”åœ¨ä¸åœçš„å‘å±•å½“ä¸­ï¼Œå¯¹æ–°æ‰‹éå¸¸çš„å‹å¥½ï¼Œå¯ä»¥æ–­å®šçš„æ˜¯Swiftå°†æ¥ä¸€å®šæ˜¯è‹¹æœæ¨çš„ä¸»æµå¼€å‘è¯­è¨€ã€‚Objective-Cåœ¨äº”å¹´ä¸ä¼šæ¶ˆäº¡ï¼Œå› ä¸ºOCçš„å¼ºå¤§ä¸æ˜¯Swiftèƒ½ä¸€æ—¶åŠä¼šå–ä»£çš„ï¼Œæˆ–è€…è¯´å°†æ¥ä¼šå¤§é‡å­˜åœ¨ç”±OCå’ŒSwiftæ··ç¼–çš„é¡¹ç›®å§ï¼ˆè™½ç„¶è¯´ç°åœ¨ä¹Ÿæœ‰ï¼Œä½†è¿˜æ˜¯æ¯”è¾ƒå°‘ï¼Œä¼°è®¡ä»¥åéƒ½ä¼šè¿™æ ·äº†ï¼‰ã€‚


1. **mutating**ï¼šä¸ºäº†èƒ½å¤Ÿåœ¨structå’Œenumeä¸­ä¿®æ”¹æ–¹æ³•ä¸­ä¿®æ”¹å±æ€§å€¼ï¼Œå¯ä»¥åœ¨æ–¹æ³•å®šä¹‰å‰æ·»åŠ å…³é”®å­—ã€‚è¯¦è§ï¼š[https://blog.csdn.net/jeffasd/article/details/55104351](https://blog.csdn.net/jeffasd/article/details/55104351)

2. **@autoclosure**ï¼šä¸»è¦æ˜¯ä¸ºäº†åŒ–ç®€é—­åŒ…åµŒå¥—å†™æ³•ï¼Œè¯¦è§ï¼š[https://www.jianshu.com/p/99ade4feb8c1](https://www.jianshu.com/p/99ade4feb8c1)

3. Swiftæ³¨é‡Šä¸­çš„æ³¨é‡Šå†™æ³•çœŸçš„æ˜¯ä¸åœçš„åˆ·æ–°æˆ‘çš„ä¸‰è§‚ã€‚ğŸ˜‚ã€‚ã€‚ã€‚è¯¦è§:[https://blog.csdn.net/ruglcc/article/details/53007850](https://blog.csdn.net/ruglcc/article/details/53007850)å’Œ[https://www.jianshu.com/p/eda4a8dc0b3f](https://www.jianshu.com/p/eda4a8dc0b3f)

4. **typealias**ï¼šå®šä¹‰åˆ«åï¼Œæˆ‘è§‰å¾—å®ƒæœ€å¥½ç”¨çš„åœ°æ–¹åœ¨äºç»™é—­åŒ…ä½¿ç”¨ï¼Œè¯¦è§ï¼š[https://www.jianshu.com/p/082202b9dc17](https://www.jianshu.com/p/082202b9dc17)

5. **Equatable**ï¼šè‡ªå®šä¹‰ç›¸ç­‰åè®®ã€‚ä¸è¿‡æˆ‘è§‰å¾—è²Œä¼¼ä¹Ÿèƒ½é€šè¿‡ä¸€ä¸ªæ–¹æ³•å»æå®šï¼Ÿä¸ç®¡æ€ä¹ˆè¯´ï¼Œé€šè¿‡`==`ç¬¦å·æ›´åŠ ç›´è§‚å§ï¼Œå…³äºä½¿ç”¨å®ƒçš„æœ‰ç‚¹å’Œç¼ºç‚¹ï¼Œè¯¦è§ï¼š[https://www.natashatherobot.com/implementing-equatable-for-protocols-swift/](https://www.natashatherobot.com/implementing-equatable-for-protocols-swift/)

6. `Array<[String : String]>`çš„å–keyå’Œvalueé—®é¢˜ã€‚

 èƒŒæ™¯ï¼šæœ€è¿‘åœ¨ä¸Šç¼–è¯‘åŸç†çš„è¯¾ï¼Œç¬¬ä¸€ä¸ªå®éªŒä¸ºç¼–å†™ä¸€ä¸ªè¯æ³•åˆ†æå™¨ï¼ŒåŸæœ¬æˆ‘çš„æƒ³æ³•æ˜¯ä½¿ç”¨Qtæ¥å®Œæˆï¼Œå†™C/C++ã€‚ä½†æ˜¯çªç„¶ä¸€é—ªï¼Œå“ˆï¼è¿™æ˜¯ä½¿ç”¨Swiftè¿›è¡Œå¼€å‘çš„å¥½æ—¶æœºï¼å› æ­¤ï¼Œæˆ‘å°±å¼€å§‹äº†......çœç•¥äº”åƒå­—ï¼Œè¯¦ç»†è§[è¿™ç¯‡æ–‡ç« ](../macOS/macOSå¼€å‘ï¼ˆè¯æ³•åˆ†æå™¨ï¼‰.md)

 åœ¨å¼€å‘è¯æ³•åˆ†æå™¨çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†è¿™ä¹ˆä¸ªé—®é¢˜ï¼ŒçŸ¥é“è¯æ³•åˆ†æçš„åŒå­¦éƒ½èƒ½æ˜ç™½ï¼Œåœ¨è¯æ³•åˆ†æé˜¶æ®µéœ€è¦ä¸€ä¸ªtokensäºŒå…ƒç»„æ¥æ”¶è¯æ³•åˆ†æåçš„ç»“æœï¼Œå› æ­¤æˆ‘è¿˜æ˜¯ç”¨äº†OCä¸­çš„é‚£å¥—æ€æƒ³ï¼Œå¯ä»¥ç”¨ä¸€ä¸ª`NSMutableArray`ï¼Œå…¶ä¸­è£…ä¸€ä¸ªä¸ªçš„å­—å…¸ï¼Œå…¶å®ä¹Ÿæœ‰ç›¸å…³æ”¾çš„æ˜¯å¼„ä¸ªäºŒç»´æ•°ç»„ï¼Œä½†æ˜¯è§‰å¾—å¥—ä¸ªå­—å…¸æ•°ç»„å¯èƒ½æ¯”è¾ƒå¥½å§ã€‚

 ä½†ä¹Ÿå°±æ˜¯è¿™ä¸ªâ€œå¯èƒ½æ¯”è¾ƒå¥½å§â€çš„æƒ³æ³•ï¼Œç›´æ¥å¯¼è‡´äº†è¿™ä¹ˆä¸ªå‘çš„å‡ºç°ï¼Œå‘ç°ä¸ç®¡æ€ä¹ˆæï¼Œéƒ½æ²¡æ³•ä½¿ç”¨è‡ªå·±ä¹‹å‰å·²æŒæ¡çš„èƒ½åŠ›å»ç­›é€‰å‡ºæ•°ç»„ä¸­æ¯ä¸ªå­—å…¸çš„keyå’Œvalueã€‚æåˆ°æœ€åï¼Œå‘ç°å¦‚æœå„ä½åŒå­¦ä¹Ÿæ˜¯è·Ÿæˆ‘ä¸€æ ·ï¼Œæœ‰`Array<String : String>`è¿™ä¸ªæ ¼å¼æ•°æ®çš„éœ€æ±‚ï¼Œæƒ³è¦éå†å‡ºæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„keyå’Œvalueï¼Œé‚£ä¹ˆå°±å¯ä»¥å‚è€ƒä¸‹è¾¹è¿™ç§åšæ³•ï¼š

 ```Swift
 // ç»™NSTextFieldåˆ·æ–°ä¸Škeyï¼Œrowä¸ºå½“å‰æ•°ç»„çš„ä¸‹æ ‡ï¼Œå…ˆè·å–åˆ°æ‰€æœ‰keysï¼Œç„¶åå–ç¬¬ä¸€ä¸ªï¼Œè™½ç„¶å®é™…ä¸Šåªæœ‰ä¸€ä¸ª
 textField.stringValue = Array(tokenArray[row].keys)[0]

 //ç»™NSTextFieldåˆ·æ–°ä¸Švalue
 textField.stringValue = Array(tokenArray[row].values)[0]

 ```

7. Swiftä¸­çš„ï¼å’Œï¼Ÿï¼ˆè§£åŒ…å®åœ¨æ˜¯å¤ªæ¶å¿ƒçš„ä¸€ä»¶äº‹äº†ï¼‰[http://www.jb51.net/article/100382.htm](http://www.jb51.net/article/100382.htm)ï¼Œæ„Ÿè§‰è¿™ç¯‡æ–‡ç« æ˜¯æŠ„çš„ï¼Œä½†æ˜¯å†™çš„å†…å®¹è¿˜ç®—æ˜äº†ã€‚

8. Swiftä¸­çš„å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ã€‚[https://www.jianshu.com/p/ba12b64f6350](https://www.jianshu.com/p/ba12b64f6350)

9. Swiftä¸­çš„å±æ€§ç›¸å…³ã€‚ç¥å¥‡çš„setå’Œgetã€‚[https://www.jianshu.com/p/071024b38a8b](https://www.jianshu.com/p/071024b38a8b)

10. **ç»§æ‰¿**ã€‚å¯¹äºè‡ªå®šä¹‰çš„ç±»è€Œè¨€ï¼ŒObjective-Cçš„ç±»ï¼Œä¸èƒ½ç»§æ‰¿è‡ªSwiftçš„ç±»ï¼Œå³è¦æ··ç¼–çš„OCç±»ä¸èƒ½æ˜¯Swiftç±»çš„å­ç±»ã€‚åè¿‡æ¥ï¼Œéœ€è¦æ··ç¼–çš„Swiftç±»å¯ä»¥ç»§æ‰¿è‡ªOCçš„ç±»ã€‚

11. Swiftä¸­çš„æ–¹æ³•é€‰æ‹©å™¨#selectorè¿˜æ˜¯ç”¨åˆ°äº†OCçš„runtimeã€‚ğŸ˜”ï¼Œè¿˜æ˜¯ä¸å¤ŸSwiftyã€‚

12. æ··ç¼–é¡¹ç›®ä¸­ï¼Œå¦‚æœä½ çš„åè®®æ˜¯ç”¨çš„Swiftå†™çš„ï¼Œè€Œä¸”å…¶ä¸­æœ‰`option`æ–¹æ³•ï¼Œé‚£å°±è¦åœ¨å¯¹åº”çš„æ–¹æ³•å‰é¢åŠ ä¸Š`@ObjC`å…³é”®è¯ã€‚

13. å¦‚ä½•ç”¨ç»™å½“å‰`WKWebView`çš„requestæ·»åŠ `Cookie`?
    é¦–å…ˆæ˜¯`setCookie`æ–¹æ³•ï¼Œ
    ```Swift
    private func setCookie() {
        var ticketCookieProperties = [AnyHashable: Any]()
        ticketCookieProperties[HTTPCookiePropertyKey.domain]    = "Your hostname"
        ticketCookieProperties[HTTPCookiePropertyKey.name]      = "Your Cookie.name"
        ticketCookieProperties[HTTPCookiePropertyKey.value]     = "Your Cookie.value"
        ticketCookieProperties[HTTPCookiePropertyKey.path]      = "/"
        ticketCookieProperties[HTTPCookiePropertyKey.expires]   = Date().addingTimeInterval(3600)
        let ticketCookie = HTTPCookie.init(properties: ticketCookieProperties as! [HTTPCookiePropertyKey : Any] )
        HTTPCookieStorage.shared.setCookie(ticketCookie!)
        
        var usernameCookieProperties = [AnyHashable: Any]()
        usernameCookieProperties[HTTPCookiePropertyKey.domain]    = "Your hostname"
        usernameCookieProperties[HTTPCookiePropertyKey.name]      = "Your Cookie.name"
        usernameCookieProperties[HTTPCookiePropertyKey.value]     = "Your Cookie.value"
        usernameCookieProperties[HTTPCookiePropertyKey.path]      = "/"
        usernameCookieProperties[HTTPCookiePropertyKey.expires]   = Date().addingTimeInterval(3600)
        let usernameCookie = HTTPCookie.init(properties: usernameCookieProperties as! [HTTPCookiePropertyKey : Any] )
        HTTPCookieStorage.shared.setCookie(usernameCookie!)
    }
    ```

    æ¥ç€æ˜¯`readCurrentCookie`æ–¹æ³•ï¼ŒæŠŠä¹‹å‰è®¾ç½®å…¨å±€`Cookie`å–å‡ºæ¥ï¼Œ
    ```Swift
    private func readCurrentCookie() -> String {
        let cookieJar = HTTPCookieStorage.shared
        var cookieString = ""
        for cookie: HTTPCookie in cookieJar.cookies! as Array {
            cookieString = cookieString + "\(cookie.name)=\(cookie.value);"
        }
        return cookieString
    }
    ```

    æœ€åæ˜¯ç»™å½“å‰çš„`WKWebView`çš„requestæ·»åŠ `Cookie`ï¼Œ
    ```Swift
    var request = URLRequest.init(url: URL(string: requestURL!)!)
    // æ³¨å…¥å…¬ç½‘æ‰€éœ€Cookie
    request.addValue(readCurrentCookie(), forHTTPHeaderField: "Cookie")
    webView?.load(request)
    ```

    è®°å¾—ä½¿ç”¨ä¹‹å‰å…ˆè°ƒç”¨`setCookie()`æ–¹æ³•æŠŠæˆ‘ä»¬éœ€è¦çš„ç›¸å…³`Cookie`ç»™ç§ä¸Šã€‚

14. æ›´æ¢å½“å‰Appçš„å¯åŠ¨å›¾æ—¶ï¼Œå¦‚æœè¿è¡ŒAppæ—¶æœªå‡ºç°ï¼Œåº”è¯¥åˆ æ‰Appé‡è£…ä¸€æ¬¡ï¼Œå¼ºåˆ¶åˆ é™¤å®‰è£…Appçš„ç¼“å­˜ã€‚

15. ç›‘å¬ç³»ç»ŸéŸ³é‡ä¸‰éƒ¨æ›²ï¼š
    ```Swift
        // 1
        import AVFoundation

        // 2
        try! AVAudioSession.sharedInstance().setActive(true)
        UIApplication.shared.beginReceivingRemoteControlEvents()

        NotificationCenter.default.addObserver(self, selector: #selector(volumeValueChange), name: NSNotification.Name(rawValue: "AVSystemController_SystemVolumeDidChangeNotification"), object: nil)

        // 3 
        // åœ¨å¯¹åº”çš„æ–¹æ³•ä¸­é€šè¿‡AVAudioSessionæ¥è·å–éŸ³é‡
        var tempVolume = AVAudioSession.sharedInstance().outputVolume
    ```

16. æƒ³è¦éšè—ç³»ç»ŸéŸ³é‡ç•Œé¢ï¼Œéœ€è¦åœ¨å¯¹åº”VCçš„`viewDidLoad` or `viewWillAppear`ä¸­å†™ä¸‹ï¼š
    ```Swift
    UIApplication.shared.keyWindow?.insertSubview(MPVolumeView(frame: CGRect.init(x: -2000, y: -2000,
                                                                                  width: 1, height: 1)), at: 0)
    ```
    å½“ç„¶ï¼Œéœ€æ±‚å‰æå¾—æ˜¯éšè—ï¼Œå¦‚æœä½ è¦æƒ³è‡ªå®šä¹‰ï¼Œé‚£å°±ä¸è¦æŠŠè¯¥è§†å›¾ç§»é™¤å½“å‰å¯è§†åŒºåŸŸä¸­ï¼Œå¦‚æœæˆ‘ä»¬å¯¹è¯¥è§†å›¾å•¥éƒ½ä¸åšï¼Œé‚£å°±ä¼šåªå‡ºç°ä¸€æ¡Sliderï¼Œæ‹–åŠ¨è¯¥Sliderå³å¯è°ƒèŠ‚éŸ³é‡ã€‚